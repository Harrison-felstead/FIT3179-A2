{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "description": "Rainfall distribution density plot from daily weather data with city selector.",
  "background": "rgba(255,255,255,0.15)", 
  "data": {
    "url": "data/raw.csv",
    "format": {
      "type": "tsv",
      "parse": {
        "Rainfall": "number"
      }
    }
  },
  "params": [
    {
      "name": "selectedCity",
      "bind": {
        "input": "select",
        "options": [
          "Adelaide","AliceSprings","Albury","Albany","Ballarat","BadgerysCreek",
          "Bendigo","Brisbane","Cairns","Canberra","Cobar","CoffsHarbour",
          "Dartmoor","Darwin","GoldCoast","Hobart","Katherine","Launceston",
          "Melbourne","MelbourneAirport","Moree","MountGambier","MountGinini",
          "Newcastle","NorahHead","NorfolkIsland","Nhil","Nuriootpa","Penrith",
          "Perth","PerthAirport","Portland","Richmond","SalmonGums","Sale",
          "Sydney","SydneyAirport","Townsville","Tuggeranong","Uluru",
          "WaggaWagga","Watsonia","Walpole","Williamtown","Witchcliffe","Wollongong"
        ],
        "name": "Select City: "
      },
      "value": "Albury"
    }
  ],
  "transform": [
    { "filter": "datum.Location == selectedCity" },
    { "filter": "isValid(datum.Rainfall) && datum.Rainfall != null && !isNaN(datum.Rainfall)" },
    {
      "density": "Rainfall",
      "bandwidth": 1,
      "extent": [0,8]
    },{
    "calculate": "datum.density * 100",
    "as": "density_percent"
  }
  ],
  "width": 370,
  "height": 200,
  "mark": {
    "type": "area",
    "color": "#4C78A8",
    "opacity": 0.7
  },
  "encoding": {
    "x": {
      "field": "value",
      "type": "quantitative",
      "title": "Rainfall (mm)"
    },
    "y": {
      "field": "density_percent",
      "type": "quantitative",
      "title": "likelihood (%)"
    }
  },
  "title": "Distribution of Daily Rainfall by City"
}
